

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>API Command Line Tools &mdash; agdc-api 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="top" title="agdc-api 0.1.0 documentation" href="index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">agdc-api 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">API Command Line Tools</a><ul>
<li><a class="reference internal" href="#retrieve-pixel-time-series">Retrieve Pixel Time Series</a><ul>
<li><a class="reference internal" href="#example-uses">Example Uses</a><ul>
<li><a class="reference internal" href="#retrieving-a-batch-of-pixel-time-series">Retrieving a &#8220;batch&#8221; of pixel time series...</a></li>
<li><a class="reference internal" href="#very-rudimentary-pixel-change-detection-using-wofs-water-extents">VERY Rudimentary Pixel Change Detection Using WOFS Water Extents...</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#retrieve-dataset">Retrieve Dataset</a><ul>
<li><a class="reference internal" href="#id1">Example Uses</a></li>
</ul>
</li>
<li><a class="reference internal" href="#retrieve-dataset-stack">Retrieve Dataset Stack</a><ul>
<li><a class="reference internal" href="#id2">Example Uses</a></li>
</ul>
</li>
<li><a class="reference internal" href="#retrieve-area-of-interest">Retrieve Area of Interest</a><ul>
<li><a class="reference internal" href="#id3">Example Uses</a></li>
</ul>
</li>
<li><a class="reference internal" href="#retrieve-area-of-interest-time-series">Retrieve Area of Interest Time Series</a><ul>
<li><a class="reference internal" href="#id4">Example Uses</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/api_tools.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="toctree-wrapper compound">
<ul class="simple">
</ul>
</div>
<div class="section" id="api-command-line-tools">
<h1>API Command Line Tools<a class="headerlink" href="#api-command-line-tools" title="Permalink to this headline">¶</a></h1>
<p>There are also a set of “tools” – i.e. packaged executables – aimed at the NPP (Non-Python “People”):</p>
<ul class="simple">
<li>Retrieve pixel time series</li>
<li>Retrieve dataset</li>
<li>Retrieve dataset time series</li>
<li>Retrieve dataset stack</li>
<li>Retrieve aoi time series</li>
<li>Summarise dataset time series</li>
<li>…</li>
</ul>
<div class="section" id="retrieve-pixel-time-series">
<h2>Retrieve Pixel Time Series<a class="headerlink" href="#retrieve-pixel-time-series" title="Permalink to this headline">¶</a></h2>
<p>The <em>Retrieve Pixel Time Series</em> tool extracts the values of a given pixel from the specified dataset over time to a
CSV file.  Pixel quality masking can be applied.  Acquisitions that are completely masked can be output or omitted:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_pixel_time_series.py -h

usage: retrieve_pixel_time_series.py

       [-h]
       [--quiet | --verbose]
       [--acq-min ACQ_MIN] [--acq-max ACQ_MAX]
       [--satellite LS5 LS7 LS8 [LS5 LS7 LS8 ...]]
       [--mask-pqa-apply]
       [--mask-pqa-mask PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR [PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR ...]]
       [--mask-wofs-apply]
       [--mask-wofs-mask DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET [DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET ...]]
       --lat LATITUDE --lon LONGITUDE
       [--hide-no-data]
       --dataset-type ARG25 PQ25 FC25 WATER DSM DEM DEM_HYDROLOGICALLY_ENFORCED DEM_SMOOTHED NDVI EVI NBR TCI
       [--bands-all | --bands-common]
       [--delimiter DELIMITER]
       [--output-directory OUTPUT_DIRECTORY]
       [--overwrite]

Retrieve Pixel Time Series

optional arguments:
  -h, --help            show this help message and exit
  --quiet               Less output
  --verbose             More output
  --acq-min ACQ_MIN     Acquisition Date
  --acq-max ACQ_MAX     Acquisition Date
  --satellite LS5 LS7 LS8 [LS5 LS7 LS8 ...]
                        The satellite(s) to include
  --mask-pqa-apply      Apply PQA mask
  --mask-pqa-mask PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR [PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR ...]
                        The PQA mask to apply
  --mask-wofs-apply     Apply WOFS mask
  --mask-wofs-mask DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET [DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET ...]
                        The WOFS mask to apply
  --lat LATITUDE        Latitude value of pixel
  --lon LONGITUDE       Longitude value of pixel
  --hide-no-data        Don&#39;t output records that are completely no data value(s)
  --dataset-type ARG25 PQ25 FC25 WATER DSM DEM DEM_HYDROLOGICALLY_ENFORCED DEM_SMOOTHED NDVI EVI NBR TCI
                        The type of dataset from which values will be retrieved
  --bands-all           Retrieve all bands with NULL values where the band is N/A
  --bands-common        Retrieve only bands in common across all satellites
  --delimiter DELIMITER
                        Field delimiter in output file
  --output-directory OUTPUT_DIRECTORY
                        Output directory
  --overwrite           Over write existing output file
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The ACQ DATE parameters support dates being specified as <code class="docutils literal"><span class="pre">YYYY</span></code> or <code class="docutils literal"><span class="pre">YYYY-MM</span></code> or <code class="docutils literal"><span class="pre">YYYY-MM-DD</span></code>.</p>
<p>The MIN parameter maps the value down - i.e. <cite>2000</cite> -&gt; <cite>2000-01-01</cite> and <cite>2000-12</cite> -&gt; <cite>2012-12-01</cite></p>
<p class="last">The MAX parameter maps the value up - i.e. <cite>2000</cite> -&gt; <cite>2000-12-31</cite> and <cite>2000-01</cite> -&gt; <cite>2012-01-31</cite></p>
</div>
<div class="section" id="example-uses">
<h3>Example Uses<a class="headerlink" href="#example-uses" title="Permalink to this headline">¶</a></h3>
<p>For example to retrieve the NBAR values:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_pixel_time_series.py --lon 120.25 --lat -20.25 --acq-min 2013-12 --acq-max 2013-12 --satellite LS7 --dataset-type ARG25 --quiet

SATELLITE,ACQUISITION DATE,BLUE,GREEN,RED,NEAR_INFRARED,SHORT_WAVE_INFRARED_1,SHORT_WAVE_INFRARED_2
LS7,2013-12-01 01:58:47,-999,-999,-999,-999,-999,-999
LS7,2013-12-10 01:53:02,-999,-999,-999,-999,-999,-999
LS7,2013-12-17 01:58:47,388,824,1605,2632,3326,2626
LS7,2013-12-26 01:53:05,-999,-999,-999,-999,-999,-999
</pre></div>
</div>
<p>and again applying pixel quality masking (defaults to selecting CLEAR pixels but can be changed via the <code class="docutils literal"><span class="pre">--mask-pqa-mask</span></code> argument):</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_pixel_time_series.py --lon 120.25 --lat -20.25 --acq-min 2013-12 --acq-max 2013-12 --satellite LS7 --dataset-type ARG25 --quiet --mask-pqa-apply

SATELLITE,ACQUISITION DATE,BLUE,GREEN,RED,NEAR_INFRARED,SHORT_WAVE_INFRARED_1,SHORT_WAVE_INFRARED_2
LS7,2013-12-01 01:58:47,-999,-999,-999,-999,-999,-999
LS7,2013-12-10 01:53:02,-999,-999,-999,-999,-999,-999
LS7,2013-12-17 01:58:47,388,824,1605,2632,3326,2626
LS7,2013-12-26 01:53:05,-999,-999,-999,-999,-999,-999
</pre></div>
</div>
<p>and again omitting no data values:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_pixel_time_series.py --lon 120.25 --lat -20.25 --acq-min 2013-12 --acq-max 2013-12 --satellite LS7 --dataset-type ARG25 --quiet --mask-pqa-apply --hide-no-data

SATELLITE,ACQUISITION DATE,BLUE,GREEN,RED,NEAR_INFRARED,SHORT_WAVE_INFRARED_1,SHORT_WAVE_INFRARED_2
LS7,2013-12-17 01:58:47,388,824,1605,2632,3326,2626
</pre></div>
</div>
<p>and mixing and matching Landsat 5, 7 and 8 (i.e. data sets that have different band combinations):</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_pixel_time_series.py --lon 120.25 --lat -20.25 --acq-min 2013-12 --acq-max 2013-12 --satellite LS7 --dataset-type ARG25 --quiet --mask-pqa-apply --hide-no-data --satellite LS7 LS8

SATELLITE,ACQUISITION DATE,BLUE,GREEN,RED,NEAR_INFRARED,SHORT_WAVE_INFRARED_1,SHORT_WAVE_INFRARED_2,COASTAL_AEROSOL
LS8,2013-12-02 01:57:55,507,871,1630,2633,3236,2513,493
LS8,2013-12-09 02:04:05,448,820,1592,2596,3260,2550,430
LS7,2013-12-17 01:58:47,388,824,1605,2632,3326,2626,
LS8,2013-12-18 01:57:47,496,847,1605,2638,3252,2509,485
</pre></div>
</div>
<p>which outputs an <strong>empty</strong> value where the band is not applicable; or to only include the bands common across all satellites:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_pixel_time_series.py --lon 120.25 --lat -20.25 --acq-min 2013-12 --acq-max 2013-12 --satellite LS7 --dataset-type ARG25 --quiet --mask-pqa-apply --hide-no-data --satellite LS7 LS8 --bands-common

SATELLITE,ACQUISITION DATE,BLUE,GREEN,RED,NEAR_INFRARED,SHORT_WAVE_INFRARED_1,SHORT_WAVE_INFRARED_2
LS8,2013-12-02 01:57:55,507,871,1630,2633,3236,2513
LS8,2013-12-09 02:04:05,448,820,1592,2596,3260,2550
LS7,2013-12-17 01:58:47,388,824,1605,2632,3326,2626
LS8,2013-12-18 01:57:47,496,847,1605,2638,3252,2509
</pre></div>
</div>
<p>To retrieve WOFS water extent values for a pixel:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_pixel_time_series.py --lon 120.25 --lat -20.25 --acq-min 2013-12 --acq-max 2013-12 --satellite LS7 --dataset-type WATER --quiet

SATELLITE,ACQUISITION DATE,WATER
LS7,2013-12-01 01:58:47,Saturation/Contiguity,2
LS7,2013-12-10 01:53:02,Saturation/Contiguity,2
LS7,2013-12-17 01:58:47,Dry,0
LS7,2013-12-26 01:53:05,Saturation/Contiguity,2
</pre></div>
</div>
<div class="section" id="retrieving-a-batch-of-pixel-time-series">
<h4>Retrieving a &#8220;batch&#8221; of pixel time series...<a class="headerlink" href="#retrieving-a-batch-of-pixel-time-series" title="Permalink to this headline">¶</a></h4>
<p>If you have a &#8220;batch&#8221; of pixels each of which you would like to retrieve a time series for, this can be scripted something like...</p>
<p>Create a text file containing the pixel locations (in this instance as lat/lon pairs separated by white space)</p>
<div class="literal-block-wrapper container" id="pixels-txt">
<div class="code-block-caption"><span class="caption-text">pixels.txt</span><a class="headerlink" href="#pixels-txt" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>-20.00  120.00
-21.25  121.25
-22.50  122.50
</pre></div>
</div>
</div>
<p>Run a little (bash) while loop to retrieve the values to files...</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span><span class="k">while</span> <span class="nb">read </span>lat lon<span class="p">;</span> <span class="k">do</span> <span class="nb">echo</span> <span class="s2">&quot;Retrieving time series for </span><span class="nv">$lon</span><span class="s2"> / </span><span class="nv">$lat</span><span class="s2">&quot;</span> <span class="p">;</span> retrieve_pixel_time_series.py --lon <span class="nv">$lon</span> --lat <span class="nv">$lat</span> --acq-min 2013-12 --acq-max 2013-12 --satellite LS7 --dataset-type ARG25 --quiet --output-directory <span class="nv">$PWD</span> <span class="p">;</span> <span class="k">done</span> &lt;pixels.txt

Retrieving <span class="nb">time </span>series <span class="k">for</span> 120.00 / -20.00
Retrieving <span class="nb">time </span>series <span class="k">for</span> 121.25 / -21.25
Retrieving <span class="nb">time </span>series <span class="k">for</span> 122.50 / -22.50
</pre></div>
</div>
<p>and then you should have the following output files...</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>ls -l

-rw-r----- <span class="m">1</span> sjo547 v10  <span class="m">345</span> Jan <span class="m">20</span> 13:11 LS7_NBAR_120.00000_-20.00000_2013-12-01_2013-12-31.csv
-rw-r----- <span class="m">1</span> sjo547 v10  <span class="m">221</span> Jan <span class="m">20</span> 13:11 LS7_NBAR_121.25000_-21.25000_2013-12-01_2013-12-31.csv
-rw-r----- <span class="m">1</span> sjo547 v10  <span class="m">221</span> Jan <span class="m">20</span> 13:11 LS7_NBAR_122.50000_-22.50000_2013-12-01_2013-12-31.csv
</pre></div>
</div>
</div>
<div class="section" id="very-rudimentary-pixel-change-detection-using-wofs-water-extents">
<h4>VERY Rudimentary Pixel Change Detection Using WOFS Water Extents...<a class="headerlink" href="#very-rudimentary-pixel-change-detection-using-wofs-water-extents" title="Permalink to this headline">¶</a></h4>
<p>A <strong>VERY</strong> basic form of change detection for a pixel can be done quite simply with the outputs from the the pixel drill by:</p>
<ol class="arabic simple">
<li>Executing the pixel drill for your chosen pixel</li>
<li>Filter the list back to only WATER and NON WATER observations</li>
<li>Filter the list back to only changes from WATER to NON WATER and vice versa</li>
</ol>
<p>For example to get the change history for the <code class="docutils literal"><span class="pre">150.07994</span></code> / <code class="docutils literal"><span class="pre">-36.36939</span></code> pixel...</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>retrieve_pixel_time_series.py --lon 150.07994 --lat -36.36939 --acq-min <span class="m">1987</span> --acq-max <span class="m">2015</span> --satellite LS5 LS7 --dataset-type WATER --quiet --output-directory <span class="nv">$PWD</span>
</pre></div>
</div>
<p>Then to filter back to only WATER and NON WATER observations...</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>grep -e <span class="s1">&#39;Wet\|Dry&#39;</span> LS_WOFS_150.07994_-36.36939_1987-01-01_2015-12-31.csv <span class="p">|</span> sort -u -t <span class="s1">&#39;,&#39;</span> -k 2,2 &gt;LS_WOFS_150.07994_-36.36939_1987-01-01_2015-12-31.filtered.sorted.csv
</pre></div>
</div>
<p>This drops back from the initial 940 observations to 215 observations.</p>
<p>Then to filter back to only observations that indication a change...</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ IFS</span><span class="o">=</span><span class="s2">&quot;,&quot;</span> <span class="p">;</span> <span class="nb">unset </span>pclass <span class="p">;</span> <span class="k">while</span> <span class="nb">read </span>sat acq class iclass<span class="p">;</span> <span class="k">do</span> <span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;</span><span class="nv">$pclass</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$class</span><span class="s2">&quot;</span> !<span class="o">=</span> <span class="s2">&quot;</span><span class="nv">$pclass</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span> <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$acq</span><span class="s2">,</span><span class="nv">$pclass</span><span class="s2">,</span><span class="nv">$class</span><span class="s2">&quot;</span><span class="p">;</span> <span class="nv">pclass</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$class</span><span class="s2">&quot;</span> <span class="p">;</span> <span class="k">fi</span><span class="p">;</span> <span class="k">done</span> &lt;LS_WOFS_150.07994_-36.36939_1987-01-01_2015-12-31.filtered.sorted.csv &gt;LS_WOFS_150.07994_-36.36939_1987-01-01_2015-12-31.changes.csv
</pre></div>
</div>
<p>This filters back to 19 &#8220;change&#8221; observations.</p>
<p>This can be imported into Excel, for example, and a couple of calculated cells added and so on...</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="7%" />
<col width="7%" />
<col width="21%" />
<col width="25%" />
<col width="23%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">DATE</th>
<th class="head">FROM</th>
<th class="head">TO</th>
<th class="head">DAYS BETWEEN</th>
<th class="head">MONTHS BETWEEN</th>
<th class="head">YEARS BETWEEN</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1988-02-25</td>
<td>&nbsp;</td>
<td>Dry</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>1988-09-29</td>
<td>Dry</td>
<td>Wet</td>
<td>217</td>
<td>7</td>
<td>1</td>
</tr>
<tr class="row-even"><td>1998-01-19</td>
<td>Wet</td>
<td>Dry</td>
<td>3,399</td>
<td>113</td>
<td>9</td>
</tr>
<tr class="row-odd"><td>2002-03-27</td>
<td>Dry</td>
<td>Wet</td>
<td>1,528</td>
<td>51</td>
<td>4</td>
</tr>
<tr class="row-even"><td>2002-04-05</td>
<td>Wet</td>
<td>Dry</td>
<td>9</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>2002-09-19</td>
<td>Dry</td>
<td>Wet</td>
<td>167</td>
<td>6</td>
<td>0</td>
</tr>
<tr class="row-even"><td>2002-10-05</td>
<td>Wet</td>
<td>Dry</td>
<td>16</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>2005-10-05</td>
<td>Dry</td>
<td>Wet</td>
<td>1,096</td>
<td>37</td>
<td>3</td>
</tr>
<tr class="row-even"><td>2005-10-06</td>
<td>Wet</td>
<td>Dry</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>2010-03-17</td>
<td>Dry</td>
<td>Wet</td>
<td>1,623</td>
<td>54</td>
<td>4</td>
</tr>
<tr class="row-even"><td>2010-04-19</td>
<td>Wet</td>
<td>Dry</td>
<td>33</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>2010-08-24</td>
<td>Dry</td>
<td>Wet</td>
<td>127</td>
<td>4</td>
<td>0</td>
</tr>
<tr class="row-even"><td>2011-09-20</td>
<td>Wet</td>
<td>Dry</td>
<td>392</td>
<td>13</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>2011-09-21</td>
<td>Dry</td>
<td>Wet</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="row-even"><td>2013-01-04</td>
<td>Wet</td>
<td>Dry</td>
<td>471</td>
<td>16</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>2013-01-20</td>
<td>Dry</td>
<td>Wet</td>
<td>16</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="row-even"><td>2013-09-10</td>
<td>Wet</td>
<td>Dry</td>
<td>233</td>
<td>8</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>2013-11-13</td>
<td>Dry</td>
<td>Wet</td>
<td>64</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="row-even"><td>2014-02-24</td>
<td>Wet</td>
<td>Dry</td>
<td>103</td>
<td>3</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="retrieve-dataset">
<h2>Retrieve Dataset<a class="headerlink" href="#retrieve-dataset" title="Permalink to this headline">¶</a></h2>
<p>The <em>Retrieve Dataset</em> tool retrieves the given dataset(s) optionally applying pixel quality masks.  It can retrieve both
&#8220;physical&#8221; - NBAR, FC, PQA - and virtual/derived/calculated - NDVI, EVI, NBR, TCI - datasets:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset.py -h

usage: retrieve_dataset.py

       [-h]
       [--quiet | --verbose]
       [--acq-min ACQ_MIN] [--acq-max ACQ_MAX]
       [--satellite LS5 LS7 LS8 [LS5 LS7 LS8 ...]]
       [--mask-pqa-apply]
       [--mask-pqa-mask PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR [PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR ...]]
       [--mask-wofs-apply]
       [--mask-wofs-mask DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET [DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET ...]]
       [--mask-vector-apply]
       [--mask-vector-file MASK_VECTOR_FILE]
       [--mask-vector-layer MASK_VECTOR_LAYER]
       [--mask-vector-feature MASK_VECTOR_FEATURE]
       --x [110 - 155] --y [-45 - -10]
       --dataset-type ARG25 PQ25 FC25 WATER DSM DEM DEM_HYDROLOGICALLY_ENFORCED DEM_SMOOTHED NDVI EVI NBR TCI [ARG25 PQ25 FC25 WATER DSM DEM DEM_HYDROLOGICALLY_ENFORCED DEM_SMOOTHED NDVI EVI NBR TCI ...]
       --output-directory OUTPUT_DIRECTORY
       [--overwrite]
       [--list-only]
       [--output-format GEOTIFF ENVI]

Retrieve Dataset

optional arguments:
  -h, --help            show this help message and exit
  --quiet               Less output
  --verbose             More output
  --acq-min ACQ_MIN     Acquisition Date
  --acq-max ACQ_MAX     Acquisition Date
  --satellite LS5 LS7 LS8 [LS5 LS7 LS8 ...]
                        The satellite(s) to include
  --mask-pqa-apply      Apply PQA mask
  --mask-pqa-mask PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR [PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR ...]
                        The PQA mask to apply
  --mask-wofs-apply     Apply WOFS mask
  --mask-wofs-mask DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET [DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET ...]
                        The WOFS mask to apply
  --mask-vector-apply   Apply mask from feature in vector file
  --mask-vector-file MASK_VECTOR_FILE
                        The vector file containing the mask
  --mask-vector-layer MASK_VECTOR_LAYER
                        The (index of) the layer containing the mask
  --mask-vector-feature MASK_VECTOR_FEATURE
                        The (index of) the feature containing the mask
  --x [110 - 155]       X grid reference
  --y [-45 - -10]       Y grid reference
  --dataset-type ARG25 PQ25 FC25 WATER DSM DEM DEM_HYDROLOGICALLY_ENFORCED DEM_SMOOTHED NDVI EVI NBR TCI [ARG25 PQ25 FC25 WATER DSM DEM DEM_HYDROLOGICALLY_ENFORCED DEM_SMOOTHED NDVI EVI NBR TCI ...]
                        The type(s) of dataset to retrieve
  --output-directory OUTPUT_DIRECTORY
                        Output directory
  --overwrite           Over write existing output file
  --list-only           List the datasets that would be retrieved rather than retrieving them
  --output-format GEOTIFF ENVI
                        The format of the output dataset
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The ACQ DATE parameters support dates being specified as <code class="docutils literal"><span class="pre">YYYY</span></code> or <code class="docutils literal"><span class="pre">YYYY-MM</span></code> or <code class="docutils literal"><span class="pre">YYYY-MM-DD</span></code>.</p>
<p>The MIN parameter maps the value down - i.e. <cite>2000</cite> -&gt; <cite>2000-01-01</cite> and <cite>2000-12</cite> -&gt; <cite>2012-12-01</cite></p>
<p class="last">The MAX parameter maps the value up - i.e. <cite>2000</cite> -&gt; <cite>2000-12-31</cite> and <cite>2000-01</cite> -&gt; <cite>2012-01-31</cite></p>
</div>
<div class="section" id="id1">
<h3>Example Uses<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>For example to find out what LS8 datasets we have from December 2013 for the 120/-25 cell:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset.py --x 120 --y -20 --satellite LS8 --acq-min 2013-12 --acq-max 2013-12 --dataset-type ARG25 --list-only --output-directory /tmp

2015-04-29 10:13:49,448 INFO
        acq = 2013-12-01 to 2013-12-31
        satellites = LS8
        PQA mask =
        WOFS mask =

2015-04-29 10:13:49,448 INFO
        x = 120
        y = -020

2015-04-29 10:13:49,448 INFO
        datasets to retrieve = ARG25
        output directory = /tmp
        over write existing = False
        list only = True

2015-04-29 10:13:50,187 INFO Would retrieve datasets [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_120_-020_2013-12-02T01-57-07.vrt]
2015-04-29 10:13:50,188 INFO Would retrieve datasets [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_NBAR_120_-020_2013-12-09T02-03-41.tif]
2015-04-29 10:13:50,188 INFO Would retrieve datasets [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_120_-020_2013-12-18T01-56-59.vrt]
</pre></div>
</div>
<p>To retrieve the NBAR and FC datasets apply PQ mask (saturation and contiguity only):</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset.py --x 120 --y -20 --satellite LS8 --acq-min 2013-12 --acq-max 2013-12 --dataset-type ARG25 FC25 --mask-pqa-apply --mask-pqa-mask PQ_MASK_SATURATION PQ_MASK_CONTIGUITY --output-directory /tmp

2015-04-29 11:07:59,063 INFO
        acq = 2013-12-01 to 2013-12-31
        satellites = LS8
        PQA mask = PQ_MASK_SATURATION PQ_MASK_CONTIGUITY
        WOFS mask =

2015-04-29 11:07:59,063 INFO
        x = 120
        y = -020

2015-04-29 11:07:59,063 INFO
        datasets to retrieve = ARG25 FC25
        output directory = /tmp
        over write existing = False
        list only = False

2015-04-29 11:07:59,257 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_120_-020_2013-12-02T01-57-07.vrt] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-02T01-57-07.tif] and pq mask [[&lt;PqaMask.PQ_MASK_SATURATION: 255&gt;, &lt;PqaMask.PQ_MASK_CONTIGUITY: 256&gt;]] and wofs [] and wofs mask [] to [/g/data/u46/sjo/testing/0.1.0-b20150428/LS8_OLI_TIRS_NBAR_WITH_PQA_120_-020_2013-12-02T01-57-07.tif]
2015-04-29 11:08:37,438 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-02T01-57-07.vrt] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-02T01-57-07.tif] and pq mask [[&lt;PqaMask.PQ_MASK_SATURATION: 255&gt;, &lt;PqaMask.PQ_MASK_CONTIGUITY: 256&gt;]] and wofs [] and wofs mask [] to [/g/data/u46/sjo/testing/0.1.0-b20150428/LS8_OLI_TIRS_FC_WITH_PQA_120_-020_2013-12-02T01-57-07.tif]

2015-04-29 11:08:53,955 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_NBAR_120_-020_2013-12-09T02-03-41.tif] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_PQA_120_-020_2013-12-09T02-03-41.tif] and pq mask [[&lt;PqaMask.PQ_MASK_SATURATION: 255&gt;, &lt;PqaMask.PQ_MASK_CONTIGUITY: 256&gt;]] and wofs [] and wofs mask [] to [/g/data/u46/sjo/testing/0.1.0-b20150428/LS8_OLI_TIRS_NBAR_WITH_PQA_120_-020_2013-12-09T02-03-41.tif]
2015-04-29 11:09:15,763 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_FC_120_-020_2013-12-09T02-03-41.tif] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_PQA_120_-020_2013-12-09T02-03-41.tif] and pq mask [[&lt;PqaMask.PQ_MASK_SATURATION: 255&gt;, &lt;PqaMask.PQ_MASK_CONTIGUITY: 256&gt;]] and wofs [] and wofs mask [] to [/g/data/u46/sjo/testing/0.1.0-b20150428/LS8_OLI_TIRS_FC_WITH_PQA_120_-020_2013-12-09T02-03-41.tif]

2015-04-29 11:09:27,515 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_120_-020_2013-12-18T01-56-59.vrt] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-18T01-56-59.tif] and pq mask [[&lt;PqaMask.PQ_MASK_SATURATION: 255&gt;, &lt;PqaMask.PQ_MASK_CONTIGUITY: 256&gt;]] and wofs [] and wofs mask [] to [/g/data/u46/sjo/testing/0.1.0-b20150428/LS8_OLI_TIRS_NBAR_WITH_PQA_120_-020_2013-12-18T01-56-59.tif]
2015-04-29 11:10:00,857 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-18T01-56-59.vrt] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-18T01-56-59.tif] and pq mask [[&lt;PqaMask.PQ_MASK_SATURATION: 255&gt;, &lt;PqaMask.PQ_MASK_CONTIGUITY: 256&gt;]] and wofs [] and wofs mask [] to [/g/data/u46/sjo/testing/0.1.0-b20150428/LS8_OLI_TIRS_FC_WITH_PQA_120_-020_2013-12-18T01-56-59.tif]
</pre></div>
</div>
<div class="literal-block-wrapper container" id="nbar-and-fc-outputs">
<div class="code-block-caption"><span class="caption-text">NBAR and FC outputs</span><a class="headerlink" href="#nbar-and-fc-outputs" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ ls -lh

-rw-r----- 1 sjo547 u46 214M Apr 29 10:28 LS8_OLI_TIRS_NBAR_WITH_PQA_120_-020_2013-12-02T01-57-07.tif
-rw-r----- 1 sjo547 u46 123M Apr 29 10:28 LS8_OLI_TIRS_FC_WITH_PQA_120_-020_2013-12-02T01-57-07.tif

-rw-r----- 1 sjo547 u46 214M Apr 29 10:28 LS8_OLI_TIRS_NBAR_WITH_PQA_120_-020_2013-12-09T02-03-41.tif
-rw-r----- 1 sjo547 u46 123M Apr 29 10:29 LS8_OLI_TIRS_FC_WITH_PQA_120_-020_2013-12-09T02-03-41.tif

-rw-r----- 1 sjo547 u46 123M Apr 29 10:30 LS8_OLI_TIRS_FC_WITH_PQA_120_-020_2013-12-18T01-56-59.tif
-rw-r----- 1 sjo547 u46 214M Apr 29 10:29 LS8_OLI_TIRS_NBAR_WITH_PQA_120_-020_2013-12-18T01-56-59.tif
</pre></div>
</div>
</div>
<div class="literal-block-wrapper container" id="ls8-oli-tirs-fc-with-pqa-120-020-2013-12-02t01-57-07-tif">
<div class="code-block-caption"><span class="caption-text"><cite>LS8_OLI_TIRS_FC_WITH_PQA_120_-020_2013-12-02T01-57-07.tif</cite>...</span><a class="headerlink" href="#ls8-oli-tirs-fc-with-pqa-120-020-2013-12-02t01-57-07-tif" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ gdalinfo LS8_OLI_TIRS_FC_WITH_PQA_120_-020_2013-12-02T01-57-07.tif

Driver: GTiff/GeoTIFF
Files: LS8_OLI_TIRS_FC_WITH_PQA_120_-020_2013-12-02T01-57-07.tif
Size is 4000, 4000
...
Origin = (120.000000000000000,-19.000000000000000)
Pixel Size = (0.000250000000000,-0.000250000000000)
...
Metadata:
  ACQUISITION_DATE=2013-12-02 01:57:31
  AREA_OR_POINT=Area
  DATASET_TYPE=FC25
  PIXEL_QUALITY_FILTER=PQ_MASK_SATURATION PQ_MASK_CONTIGUITY
  SATELLITE=LS8
  X_INDEX=120
  Y_INDEX=-020
...
Band 1 Block=4000x1 Type=Int16, ColorInterp=Gray
  Description = PHOTOSYNTHETIC_VEGETATION
  Minimum=0.000, Maximum=16959.000, Mean=6743.956, StdDev=6415.091
  NoData Value=-999
...
Band 2 Block=4000x1 Type=Int16, ColorInterp=Undefined
  Description = NON_PHOTOSYNTHETIC_VEGETATION
  Minimum=0.000, Maximum=21059.000, Mean=10392.389, StdDev=4577.513
  NoData Value=-999
...
Band 3 Block=4000x1 Type=Int16, ColorInterp=Undefined
  Description = BARE_SOIL
  Minimum=0.000, Maximum=16959.000, Mean=5404.868, StdDev=7320.007
  NoData Value=-999
...
Band 4 Block=4000x1 Type=Int16, ColorInterp=Undefined
  Description = UNMIXING_ERROR
  Minimum=326.000, Maximum=16959.000, Mean=7182.122, StdDev=6224.030
  NoData Value=-999
</pre></div>
</div>
</div>
<p>To generate NDVI and NBR datasets from each NBAR dataset after applying PQA:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset.py --x 120 --y -20 --satellite LS8 --acq-min 2013-12 --acq-max 2013-12 --dataset-type NDVI NBR --mask-pqa-apply --output-directory /tmp

2015-04-29 11:45:14,860 INFO
        acq = 2013-12-01 to 2013-12-31
        satellites = LS8
        PQA mask = PQ_MASK_CLEAR
        WOFS mask =

2015-04-29 11:45:14,860 INFO
        x = 120
        y = -020

2015-04-29 11:45:14,861 INFO
        datasets to retrieve = NDVI NBR
        output directory = /tmp
        over write existing = False
        list only = False

2015-04-29 11:45:15,474 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_120_-020_2013-12-02T01-57-07.vrt] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-02T01-57-07.tif] and pq mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and wofs [] and wofs mask [] to [/g/data/u46/sjo/testing/0.1.0-b20150428/LS8_OLI_TIRS_NDVI_WITH_PQA_120_-020_2013-12-02T01-57-07.tif]
2015-04-29 11:45:23,697 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_120_-020_2013-12-02T01-57-07.vrt] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-02T01-57-07.tif] and pq mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and wofs [] and wofs mask [] to [/g/data/u46/sjo/testing/0.1.0-b20150428/LS8_OLI_TIRS_NBR_WITH_PQA_120_-020_2013-12-02T01-57-07.tif]

2015-04-29 11:45:30,774 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_NBAR_120_-020_2013-12-09T02-03-41.tif] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_PQA_120_-020_2013-12-09T02-03-41.tif] and pq mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and wofs [] and wofs mask [] to [/g/data/u46/sjo/testing/0.1.0-b20150428/LS8_OLI_TIRS_NDVI_WITH_PQA_120_-020_2013-12-09T02-03-41.tif]
2015-04-29 11:45:34,722 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_NBAR_120_-020_2013-12-09T02-03-41.tif] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_PQA_120_-020_2013-12-09T02-03-41.tif] and pq mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and wofs [] and wofs mask [] to [/g/data/u46/sjo/testing/0.1.0-b20150428/LS8_OLI_TIRS_NBR_WITH_PQA_120_-020_2013-12-09T02-03-41.tif]

2015-04-29 11:45:38,428 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_120_-020_2013-12-18T01-56-59.vrt] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-18T01-56-59.tif] and pq mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and wofs [] and wofs mask [] to [/g/data/u46/sjo/testing/0.1.0-b20150428/LS8_OLI_TIRS_NDVI_WITH_PQA_120_-020_2013-12-18T01-56-59.tif]
2015-04-29 11:45:45,491 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_120_-020_2013-12-18T01-56-59.vrt] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-18T01-56-59.tif] and pq mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and wofs [] and wofs mask [] to [/g/data/u46/sjo/testing/0.1.0-b20150428/LS8_OLI_TIRS_NBR_WITH_PQA_120_-020_2013-12-18T01-56-59.tif]
</pre></div>
</div>
<div class="literal-block-wrapper container" id="ndvi-and-nbr-outputs">
<div class="code-block-caption"><span class="caption-text">NDVI and NBR outputs</span><a class="headerlink" href="#ndvi-and-nbr-outputs" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ ls -lh

-rw-r----- 1 sjo547 u46 62M Apr 29 11:45 LS8_OLI_TIRS_NDVI_WITH_PQA_120_-020_2013-12-02T01-57-07.tif
-rw-r----- 1 sjo547 u46 62M Apr 29 11:45 LS8_OLI_TIRS_NBR_WITH_PQA_120_-020_2013-12-02T01-57-07.tif

-rw-r----- 1 sjo547 u46 62M Apr 29 11:45 LS8_OLI_TIRS_NDVI_WITH_PQA_120_-020_2013-12-09T02-03-41.tif
-rw-r----- 1 sjo547 u46 62M Apr 29 11:45 LS8_OLI_TIRS_NBR_WITH_PQA_120_-020_2013-12-09T02-03-41.tif

-rw-r----- 1 sjo547 u46 62M Apr 29 11:45 LS8_OLI_TIRS_NBR_WITH_PQA_120_-020_2013-12-18T01-56-59.tif
-rw-r----- 1 sjo547 u46 62M Apr 29 11:45 LS8_OLI_TIRS_NDVI_WITH_PQA_120_-020_2013-12-18T01-56-59.tif
</pre></div>
</div>
</div>
<div class="literal-block-wrapper container" id="ls8-oli-tirs-ndvi-with-pqa-120-020-2013-12-02t01-57-07-tif">
<div class="code-block-caption"><span class="caption-text"><cite>LS8_OLI_TIRS_NDVI_WITH_PQA_120_-020_2013-12-02T01-57-07.tif</cite>...</span><a class="headerlink" href="#ls8-oli-tirs-ndvi-with-pqa-120-020-2013-12-02t01-57-07-tif" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ gdalinfo LS8_OLI_TIRS_NDVI_WITH_PQA_120_-020_2013-12-02T01-57-07.tif

Driver: GTiff/GeoTIFF
Files: LS8_OLI_TIRS_NDVI_WITH_PQA_120_-020_2013-12-02T01-57-07.tif
Size is 4000, 4000
...
Origin = (120.000000000000000,-19.000000000000000)
Pixel Size = (0.000250000000000,-0.000250000000000)
...
Metadata:
  ACQUISITION_DATE=2013-12-02 01:57:31
  AREA_OR_POINT=Area
  DATASET_TYPE=NDVI
  PIXEL_QUALITY_FILTER=PQ_MASK_CLEAR
  SATELLITE=LS8
  X_INDEX=120
  Y_INDEX=-020
...
Band 1 Block=4000x1 Type=Float32, ColorInterp=Gray
  Description = NDVI
  Minimum=-0.585, Maximum=100000002004089995264.000, Mean=82418751651744006144.000, StdDev=38066057144637997056.000
  NoData Value=nan
</pre></div>
</div>
</div>
<p>To retrieve the FC datasets applying PQ mask in ENVI format:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset.py --acq-min 2014-01 --acq-max 2014-01 --satellite LS5 LS7 LS8 --mask-pqa-apply --x 120 --y -25 --dataset-type FC25 --output-directory /tmp --output-format ENVI

2015-05-04 15:46:04,641 INFO
        acq = 2014-01-01 to 2014-01-31
        satellites = LS5 LS7 LS8
        PQA mask = PQ_MASK_CLEAR
        WOFS mask =

2015-05-04 15:46:04,641 INFO
        x = 120
        y = -025

2015-05-04 15:46:04,642 INFO
        datasets to retrieve = FC25
        output directory = /tmp
        over write existing = False
        list only = False
        output format = ENVI

2015-05-04 15:46:04,863 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-025/2014/mosaic_cache/LS8_OLI_TIRS_FC_120_-025_2014-01-03T01-58-04.vrt] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-025/2014/mosaic_cache/LS8_OLI_TIRS_PQA_120_-025_2014-01-03T01-58-04.tif] and pq mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and wofs [] and wofs mask [] to [ENVI] file [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_120_-025_2014-01-03T01-58-04.dat]
2015-05-04 15:46:12,963 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/120_-025/2014/LS7_ETM_FC_120_-025_2014-01-04T01-47-21.tif] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/120_-025/2014/LS7_ETM_PQA_120_-025_2014-01-04T01-47-21.148399.tif] and pq mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and wofs [] and wofs mask [] to [ENVI] file [/tmp/LS7_ETM_FC_WITH_PQA_120_-025_2014-01-04T01-47-21.dat]
2015-05-04 15:46:15,648 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-025/2014/LS8_OLI_TIRS_FC_120_-025_2014-01-12T01-52-08.tif] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-025/2014/LS8_OLI_TIRS_PQA_120_-025_2014-01-12T01-52-08.tif] and pq mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and wofs [] and wofs mask [] to [ENVI] file [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_120_-025_2014-01-12T01-52-08.dat]
2015-05-04 15:46:18,494 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-025/2014/LS8_OLI_TIRS_FC_120_-025_2014-01-19T01-58-14.tif] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-025/2014/LS8_OLI_TIRS_PQA_120_-025_2014-01-19T01-58-14.tif] and pq mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and wofs [] and wofs mask [] to [ENVI] file [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_120_-025_2014-01-19T01-58-14.dat]
</pre></div>
</div>
<div class="literal-block-wrapper container" id="fc-envi-outputs">
<div class="code-block-caption"><span class="caption-text">FC ENVI outputs</span><a class="headerlink" href="#fc-envi-outputs" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ ls -lh

-rw-r----- 1 sjo547 u46 123M May  4 15:46 LS7_ETM_FC_WITH_PQA_120_-025_2014-01-04T01-47-21.dat
-rw-r----- 1 sjo547 u46  583 May  4 15:46 LS7_ETM_FC_WITH_PQA_120_-025_2014-01-04T01-47-21.hdr

-rw-r----- 1 sjo547 u46 123M May  4 15:46 LS8_OLI_TIRS_FC_WITH_PQA_120_-025_2014-01-03T01-58-04.dat
-rw-r----- 1 sjo547 u46  588 May  4 15:46 LS8_OLI_TIRS_FC_WITH_PQA_120_-025_2014-01-03T01-58-04.hdr

-rw-r----- 1 sjo547 u46 123M May  4 15:46 LS8_OLI_TIRS_FC_WITH_PQA_120_-025_2014-01-12T01-52-08.dat
-rw-r----- 1 sjo547 u46  588 May  4 15:46 LS8_OLI_TIRS_FC_WITH_PQA_120_-025_2014-01-12T01-52-08.hdr

-rw-r----- 1 sjo547 u46 123M May  4 15:46 LS8_OLI_TIRS_FC_WITH_PQA_120_-025_2014-01-19T01-58-14.dat
-rw-r----- 1 sjo547 u46  588 May  4 15:46 LS8_OLI_TIRS_FC_WITH_PQA_120_-025_2014-01-19T01-58-14.hdr
</pre></div>
</div>
</div>
<div class="literal-block-wrapper container" id="ls7-etm-fc-with-pqa-120-025-2014-01-04t01-47-21-dat">
<div class="code-block-caption"><span class="caption-text"><cite>LS7_ETM_FC_WITH_PQA_120_-025_2014-01-04T01-47-21.dat</cite>...</span><a class="headerlink" href="#ls7-etm-fc-with-pqa-120-025-2014-01-04t01-47-21-dat" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ gdalinfo LS7_ETM_FC_WITH_PQA_120_-025_2014-01-04T01-47-21.dat

Driver: ENVI/ENVI .hdr Labelled
Files: LS7_ETM_FC_WITH_PQA_120_-025_2014-01-04T01-47-21.dat
       LS7_ETM_FC_WITH_PQA_120_-025_2014-01-04T01-47-21.hdr
Size is 4000, 4000
...
Origin = (120.000000000000000,-19.000000000000000)
Pixel Size = (0.000250000000000,-0.000250000000000)
...
Metadata:
  ACQUISITION_DATE=2014-01-04 01:47:45
  DATASET_TYPE=FC25
  PIXEL_QUALITY_FILTER=PQ_MASK_CLEAR
  SATELLITE=LS7
  X_INDEX=120
  Y_INDEX=-025
  Band_1=PHOTOSYNTHETIC_VEGETATION
  Band_2=NON_PHOTOSYNTHETIC_VEGETATION
  Band_3=BARE_SOIL
  Band_4=UNMIXING_ERROR
...
Band 1 Block=4000x1 Type=Int16, ColorInterp=Gray
  Description = PHOTOSYNTHETIC_VEGETATION
  Minimum=0.000, Maximum=16959.000, Mean=6743.956, StdDev=6415.091
  NoData Value=-999
...
Band 2 Block=4000x1 Type=Int16, ColorInterp=Undefined
  Description = NON_PHOTOSYNTHETIC_VEGETATION
  Minimum=0.000, Maximum=21059.000, Mean=10392.389, StdDev=4577.513
  NoData Value=-999
...
Band 3 Block=4000x1 Type=Int16, ColorInterp=Undefined
  Description = BARE_SOIL
  Minimum=0.000, Maximum=16959.000, Mean=5404.868, StdDev=7320.007
  NoData Value=-999
...
Band 4 Block=4000x1 Type=Int16, ColorInterp=Undefined
  Description = UNMIXING_ERROR
  Minimum=326.000, Maximum=16959.000, Mean=7182.122, StdDev=6224.030
  NoData Value=-999
</pre></div>
</div>
</div>
<p>To retrieve the Landsat 8 <em>Surface Reflectance</em> dataset from 11<sub>th</sub> October 2013:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset.py --acq-min 2013-10-11 --acq-max 2013-10-11 --satellite LS8 --x 148 --y -36 --dataset-type ARG25 --output-directory /tmp
2015-05-06 14:17:14,639 INFO
        acq = 2013-10-11 to 2013-10-11
        satellites = LS8
        PQA mask =
        WOFS mask =

2015-05-06 14:17:14,639 INFO
        x = 148
        y = -036
        VECTOR mask =

2015-05-06 14:17:14,639 INFO
        datasets to retrieve = ARG25
        output directory = /tmp
        over write existing = False
        list only = False
        output format = GEOTIFF

2015-05-06 14:17:14,784 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.vrt] with pq [] and pq mask [] and wofs [] and wofs mask [] to [GEOTIFF] file [/tmp/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.tif]
</pre></div>
</div>
<div class="figure" id="id5">
<img alt="_images/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.png" src="_images/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.png" />
<p class="caption"><span class="caption-text"><code class="docutils literal"><span class="pre">LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.tif</span></code></span></p>
</div>
<p>To retrieve the Landsat 8 <em>Surface Reflectance</em> dataset from 11<sub>th</sub> October 2013 with Pixel Quality masking applied:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset.py --acq-min 2013-10-11 --acq-max 2013-10-11 --satellite LS8 --x 148 --y -36 --dataset-type ARG25 --output-directory $PWD --mask-pqa-apply

2015-05-06 14:38:49,329 INFO
        acq = 2013-10-11 to 2013-10-11
        satellites = LS8
        PQA mask = PQ_MASK_CLEAR
        WOFS mask =

2015-05-06 14:38:49,330 INFO
        x = 148
        y = -036
        VECTOR mask =

2015-05-06 14:38:49,330 INFO
        datasets to retrieve = ARG25
        output directory = /tmp
        over write existing = False
        list only = False
        output format = GEOTIFF

2015-05-06 14:38:49,521 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.vrt] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_PQA_148_-036_2013-10-11T23-51-59.tif] and pq mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and wofs [] and wofs mask [] to [GEOTIFF] file [/tmp/LS8_OLI_TIRS_NBAR_WITH_PQA_148_-036_2013-10-11T23-51-59.tif]
</pre></div>
</div>
<div class="figure" id="id6">
<img alt="_images/LS8_OLI_TIRS_NBAR_WITH_PQA_148_-036_2013-10-11T23-51-59.png" src="_images/LS8_OLI_TIRS_NBAR_WITH_PQA_148_-036_2013-10-11T23-51-59.png" />
<p class="caption"><span class="caption-text"><code class="docutils literal"><span class="pre">LS8_OLI_TIRS_NBAR_WITH_PQA_148_-036_2013-10-11T23-51-59.tif</span></code></span></p>
</div>
<p>To retrieve the Landsat 8 <em>Surface Reflectance</em> dataset from 11<sub>th</sub> October 2013 with Pixel Quality and an ACT area of interest masking applied:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset.py --acq-min 2013-10-11 --acq-max 2013-10-11 --satellite LS8 --x 148 --y -36 --dataset-type ARG25 --output-directory /tmp --mask-pqa-apply --mask-vector-apply --mask-vector-file australian_states.shp --mask-vector-layer australian_states --mask-vector-feature 4

2015-05-06 14:43:32,967 INFO
        acq = 2013-10-11 to 2013-10-11
        satellites = LS8
        PQA mask = PQ_MASK_CLEAR
        WOFS mask =

2015-05-06 14:43:32,967 INFO
        x = 148
        y = -036
        VECTOR mask = /g/data/u46/sjo/tmp/Mainlands.shp Mainlands 4

2015-05-06 14:43:32,967 INFO
        datasets to retrieve = ARG25
        output directory = /g/data/u46/sjo/testing/0.1.0
        over write existing = False
        list only = False
        output format = GEOTIFF

2015-05-06 14:43:33,285 INFO Retrieving data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.vrt] with pq [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_PQA_148_-036_2013-10-11T23-51-59.tif] and pq mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and wofs [] and wofs mask [] to [GEOTIFF] file [/tmp/LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_148_-036_2013-10-11T23-51-59.tif]
</pre></div>
</div>
<div class="figure" id="id7">
<img alt="_images/LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_148_-036_2013-10-11T23-51-59.png" src="_images/LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_148_-036_2013-10-11T23-51-59.png" />
<p class="caption"><span class="caption-text"><code class="docutils literal"><span class="pre">LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_148_-036_2013-10-11T23-51-59.tif</span></code></span></p>
</div>
</div>
</div>
<div class="section" id="retrieve-dataset-stack">
<h2>Retrieve Dataset Stack<a class="headerlink" href="#retrieve-dataset-stack" title="Permalink to this headline">¶</a></h2>
<p>The <em>Retrieve Dataset Stack</em> tool retrieves the given dataset(s), optionally applying pixel quality masks, as a band
stack.</p>
<p>That is, a raster file for each band of the requested dataset where each band represents that band from a given acquisition
forming a time series.</p>
<p>It can retrieve both &#8220;physical&#8221; - NBAR, FC, PQA - and virtual/derived/calculated - NDVI, EVI, NBR, TCI - datasets:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset_stack.py -h

usage: retrieve_dataset_stack.py

       [-h]
       [--quiet | --verbose] [
       --acq-min ACQ_MIN] [--acq-max ACQ_MAX]
       [--satellite LS5 LS7 LS8 [LS5 LS7 LS8 ...]]
       [--mask-pqa-apply]
       [--mask-pqa-mask PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR [PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR ...]]
       [--mask-wofs-apply]
       [--mask-wofs-mask DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET [DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET ...]]
       [--mask-vector-apply]
       [--mask-vector-file MASK_VECTOR_FILE]
       [--mask-vector-layer MASK_VECTOR_LAYER]
       [--mask-vector-feature MASK_VECTOR_FEATURE]
       --x [110 - 155] --y [-45 - -10]
       --dataset-type ARG25 PQ25 FC25 WATER DSM DEM DEM_HYDROLOGICALLY_ENFORCED DEM_SMOOTHED NDVI EVI NBR TCI
       [--bands-all | --bands-common]
       --output-directory OUTPUT_DIRECTORY
       [--overwrite]
       [--list-only]
       [--output-format GEOTIFF ENVI]

Retrieve Dataset Stack

optional arguments:
  -h, --help            show this help message and exit
  --quiet               Less output
  --verbose             More output
  --acq-min ACQ_MIN     Acquisition Date
  --acq-max ACQ_MAX     Acquisition Date
  --satellite LS5 LS7 LS8 [LS5 LS7 LS8 ...]
                        The satellite(s) to include
  --mask-pqa-apply      Apply PQA mask
  --mask-pqa-mask PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR [PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR ...]
                        The PQA mask to apply
  --mask-wofs-apply     Apply WOFS mask
  --mask-wofs-mask DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET [DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET ...]
                        The WOFS mask to apply
  --mask-vector-apply   Apply mask from feature in vector file
  --mask-vector-file MASK_VECTOR_FILE
                        The vector file containing the mask
  --mask-vector-layer MASK_VECTOR_LAYER
                        The (index of) the layer containing the mask
  --mask-vector-feature MASK_VECTOR_FEATURE
                        The (index of) the feature containing the mask
  --x [110 - 155]       X grid reference
  --y [-45 - -10]       Y grid reference
  --dataset-type ARG25 PQ25 FC25 WATER DSM DEM DEM_HYDROLOGICALLY_ENFORCED DEM_SMOOTHED NDVI EVI NBR TCI
                        The type(s) of dataset to retrieve
  --bands-all           Retrieve all bands with NULL values where the band is N/A
  --bands-common        Retrieve only bands in common across all satellites
  --output-directory OUTPUT_DIRECTORY
                        Output directory
  --overwrite           Over write existing output file
  --list-only           List the datasets that would be retrieved rather than retrieving them
  --output-format GEOTIFF ENVI
                        The format of the output dataset
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The ACQ DATE parameters support dates being specified as <code class="docutils literal"><span class="pre">YYYY</span></code> or <code class="docutils literal"><span class="pre">YYYY-MM</span></code> or <code class="docutils literal"><span class="pre">YYYY-MM-DD</span></code>.</p>
<p>The MIN parameter maps the value down - i.e. <cite>2000</cite> -&gt; <cite>2000-01-01</cite> and <cite>2000-12</cite> -&gt; <cite>2012-12-01</cite></p>
<p class="last">The MAX parameter maps the value up - i.e. <cite>2000</cite> -&gt; <cite>2000-12-31</cite> and <cite>2000-01</cite> -&gt; <cite>2012-01-31</cite></p>
</div>
<div class="section" id="id2">
<h3>Example Uses<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>For example to stack the LS8 Fractional Cover datasets from December 2013 for the 120/-25 cell:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset_stack.py --x 120 --y -20 --satellite LS8 --acq-min 2013-12 --acq-max 2013-12 --dataset-type FC25 --mask-pqa-apply --output-directory /tmp

2015-05-04 13:58:15,015 INFO
        acq = 2013-12-01 to 2013-12-31
        satellites = LS8
        PQA mask = PQ_MASK_CLEAR
        WOFS mask =

2015-05-04 13:58:15,016 INFO
        x = 120
        y = -020

2015-05-04 13:58:15,016 INFO
        datasets to retrieve = FC25
        bands to retrieve = [&#39;PHOTOSYNTHETIC_VEGETATION&#39;, &#39;NON_PHOTOSYNTHETIC_VEGETATION&#39;, &#39;BARE_SOIL&#39;, &#39;UNMIXING_ERROR&#39;]
        output directory = /tmp
        over write existing = False
        list only = False

2015-05-04 13:58:15,166 INFO Total tiles found [3]

2015-05-04 13:58:15,167 INFO Creating stack for band [PHOTOSYNTHETIC_VEGETATION]
2015-05-04 13:58:15,167 INFO Total tiles for band [PHOTOSYNTHETIC_VEGETATION] is [3]
2015-05-04 13:58:15,353 INFO Stacking [PHOTOSYNTHETIC_VEGETATION] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-02T01-57-07.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-02T01-57-07.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-02T01-57-07.tif]
2015-05-04 13:58:23,276 INFO Stacking [PHOTOSYNTHETIC_VEGETATION] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_FC_120_-020_2013-12-09T02-03-41.tif] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_PQA_120_-020_2013-12-09T02-03-41.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-09T02-03-41.tif]
2015-05-04 13:58:26,521 INFO Stacking [PHOTOSYNTHETIC_VEGETATION] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-18T01-56-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-18T01-56-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-18T01-56-59.tif]

2015-05-04 13:58:33,807 INFO Creating stack for band [NON_PHOTOSYNTHETIC_VEGETATION]
2015-05-04 13:58:33,807 INFO Total tiles for band [NON_PHOTOSYNTHETIC_VEGETATION] is [3]
2015-05-04 13:58:33,930 INFO Stacking [NON_PHOTOSYNTHETIC_VEGETATION] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-02T01-57-07.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-02T01-57-07.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_NON_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-02T01-57-07.tif]
2015-05-04 13:58:41,766 INFO Stacking [NON_PHOTOSYNTHETIC_VEGETATION] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_FC_120_-020_2013-12-09T02-03-41.tif] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_PQA_120_-020_2013-12-09T02-03-41.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_NON_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-09T02-03-41.tif]
2015-05-04 13:58:45,061 INFO Stacking [NON_PHOTOSYNTHETIC_VEGETATION] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-18T01-56-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-18T01-56-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_NON_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-18T01-56-59.tif]

2015-05-04 13:58:52,159 INFO Creating stack for band [BARE_SOIL]
2015-05-04 13:58:52,159 INFO Total tiles for band [BARE_SOIL] is [3]
2015-05-04 13:58:52,283 INFO Stacking [BARE_SOIL] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-02T01-57-07.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-02T01-57-07.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-02T01-57-07.tif]
2015-05-04 13:58:59,740 INFO Stacking [BARE_SOIL] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_FC_120_-020_2013-12-09T02-03-41.tif] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_PQA_120_-020_2013-12-09T02-03-41.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-09T02-03-41.tif]
2015-05-04 13:59:02,922 INFO Stacking [BARE_SOIL] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-18T01-56-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-18T01-56-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-18T01-56-59.tif]

2015-05-04 13:59:10,027 INFO Creating stack for band [UNMIXING_ERROR]
2015-05-04 13:59:10,028 INFO Total tiles for band [UNMIXING_ERROR] is [3]
2015-05-04 13:59:10,160 INFO Stacking [UNMIXING_ERROR] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-02T01-57-07.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-02T01-57-07.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_UNMIXING_ERROR_120_-020_2013-12-02T01-57-07.tif]
2015-05-04 13:59:17,514 INFO Stacking [UNMIXING_ERROR] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_FC_120_-020_2013-12-09T02-03-41.tif] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_PQA_120_-020_2013-12-09T02-03-41.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_UNMIXING_ERROR_120_-020_2013-12-09T02-03-41.tif]
2015-05-04 13:59:20,467 INFO Stacking [UNMIXING_ERROR] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-18T01-56-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-18T01-56-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_UNMIXING_ERROR_120_-020_2013-12-18T01-56-59.tif]
</pre></div>
</div>
<div class="literal-block-wrapper container" id="fc-stack-outputs">
<div class="code-block-caption"><span class="caption-text">FC stack outputs</span><a class="headerlink" href="#fc-stack-outputs" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ ls -lh

-rw-r----- 1 sjo547 u46 92M May  4 13:59 LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-02T01-57-07.tif
-rw-r----- 1 sjo547 u46 92M May  4 13:58 LS8_OLI_TIRS_FC_WITH_PQA_STACK_NON_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-02T01-57-07.tif
-rw-r----- 1 sjo547 u46 92M May  4 13:58 LS8_OLI_TIRS_FC_WITH_PQA_STACK_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-02T01-57-07.tif
-rw-r----- 1 sjo547 u46 92M May  4 13:59 LS8_OLI_TIRS_FC_WITH_PQA_STACK_UNMIXING_ERROR_120_-020_2013-12-02T01-57-07.tif
</pre></div>
</div>
</div>
<div class="literal-block-wrapper container" id="ls8-oli-tirs-fc-with-pqa-stack-bare-soil-120-020-2013-12-02t01-57-07-tif">
<div class="code-block-caption"><span class="caption-text"><cite>LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-02T01-57-07.tif</cite>...</span><a class="headerlink" href="#ls8-oli-tirs-fc-with-pqa-stack-bare-soil-120-020-2013-12-02t01-57-07-tif" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ gdalinfo LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-02T01-57-07.tif
Driver: GTiff/GeoTIFF
Files: LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-02T01-57-07.tif
Size is 4000, 4000
...
Origin = (120.000000000000000,-19.000000000000000)
Pixel Size = (0.000250000000000,-0.000250000000000)
...
Metadata:
  ACQUISITION_DATE=2013_12_01 to 2013_12_31
  AREA_OR_POINT=Area
  DATASET_TYPE=FC25
  PIXEL_QUALITY_FILTER=PQ_MASK_CLEAR
  SATELLITES=LS8
  X_INDEX=120
  Y_INDEX=-020
...
Band 1 Block=4000x1 Type=Int16, ColorInterp=Gray
  Description = LS8_OLI_TIRS_FC_120_-020_2013-12-02T01-57-07.vrt
  NoData Value=-999
  Metadata:
    ACQ_DATE=2013_12_02
    SATELLITE=LS8
...
Band 2 Block=4000x1 Type=Int16, ColorInterp=Undefined
  Description = LS8_OLI_TIRS_FC_120_-020_2013-12-09T02-03-41.tif
  NoData Value=-999
  Metadata:
    ACQ_DATE=2013_12_09
    SATELLITE=LS8
...
Band 3 Block=4000x1 Type=Int16, ColorInterp=Undefined
  Description = LS8_OLI_TIRS_FC_120_-020_2013-12-18T01-56-59.vrt
  NoData Value=-999
  Metadata:
    ACQ_DATE=2013_12_18
    SATELLITE=LS8
</pre></div>
</div>
</div>
<p>As ENVI format:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset_stack.py --x 120 --y -20 --satellite LS8 --acq-min 2013-12 --acq-max 2013-12 --dataset-type FC25 --mask-pqa-apply --output-directory /tmp --output-format ENVI

2015-05-04 16:07:34,072 INFO
        acq = 2013-12-01 to 2013-12-31
        satellites = LS8
        PQA mask = PQ_MASK_CLEAR
        WOFS mask =

2015-05-04 16:07:34,072 INFO
        x = 120
        y = -020

2015-05-04 16:07:34,072 INFO
        datasets to retrieve = FC25
        bands to retrieve = [&#39;PHOTOSYNTHETIC_VEGETATION&#39;, &#39;NON_PHOTOSYNTHETIC_VEGETATION&#39;, &#39;BARE_SOIL&#39;, &#39;UNMIXING_ERROR&#39;]
        output directory = /tmp
        over write existing = False
        list only = False
        output format = ENVI

2015-05-04 16:07:34,294 INFO Total tiles found [3]

2015-05-04 16:07:34,294 INFO Creating stack for band [PHOTOSYNTHETIC_VEGETATION]
2015-05-04 16:07:34,294 INFO Total tiles for band [PHOTOSYNTHETIC_VEGETATION] is [3]
2015-05-04 16:07:34,537 INFO Stacking [PHOTOSYNTHETIC_VEGETATION] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-02T01-57-07.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-02T01-57-07.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-02T01-57-07.dat]
2015-05-04 16:07:41,748 INFO Stacking [PHOTOSYNTHETIC_VEGETATION] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_FC_120_-020_2013-12-09T02-03-41.tif] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_PQA_120_-020_2013-12-09T02-03-41.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-09T02-03-41.dat]
2015-05-04 16:07:44,019 INFO Stacking [PHOTOSYNTHETIC_VEGETATION] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-18T01-56-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-18T01-56-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-18T01-56-59.dat]

2015-05-04 16:07:50,668 INFO Creating stack for band [NON_PHOTOSYNTHETIC_VEGETATION]
2015-05-04 16:07:50,668 INFO Total tiles for band [NON_PHOTOSYNTHETIC_VEGETATION] is [3]
2015-05-04 16:07:50,815 INFO Stacking [NON_PHOTOSYNTHETIC_VEGETATION] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-02T01-57-07.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-02T01-57-07.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_NON_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-02T01-57-07.dat]
2015-05-04 16:07:58,340 INFO Stacking [NON_PHOTOSYNTHETIC_VEGETATION] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_FC_120_-020_2013-12-09T02-03-41.tif] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_PQA_120_-020_2013-12-09T02-03-41.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_NON_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-09T02-03-41.dat]
2015-05-04 16:08:00,590 INFO Stacking [NON_PHOTOSYNTHETIC_VEGETATION] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-18T01-56-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-18T01-56-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_NON_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-18T01-56-59.dat]

2015-05-04 16:08:07,055 INFO Creating stack for band [BARE_SOIL]
2015-05-04 16:08:07,056 INFO Total tiles for band [BARE_SOIL] is [3]
2015-05-04 16:08:07,194 INFO Stacking [BARE_SOIL] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-02T01-57-07.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-02T01-57-07.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-02T01-57-07.dat]
2015-05-04 16:08:14,140 INFO Stacking [BARE_SOIL] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_FC_120_-020_2013-12-09T02-03-41.tif] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_PQA_120_-020_2013-12-09T02-03-41.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-09T02-03-41.dat]
2015-05-04 16:08:16,343 INFO Stacking [BARE_SOIL] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-18T01-56-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-18T01-56-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-18T01-56-59.dat]

2015-05-04 16:08:23,121 INFO Creating stack for band [UNMIXING_ERROR]
2015-05-04 16:08:23,121 INFO Total tiles for band [UNMIXING_ERROR] is [3]
2015-05-04 16:08:23,270 INFO Stacking [UNMIXING_ERROR] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-02T01-57-07.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-02T01-57-07.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_UNMIXING_ERROR_120_-020_2013-12-02T01-57-07.dat]
2015-05-04 16:08:30,392 INFO Stacking [UNMIXING_ERROR] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_FC_120_-020_2013-12-09T02-03-41.tif] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/LS8_OLI_TIRS_PQA_120_-020_2013-12-09T02-03-41.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_UNMIXING_ERROR_120_-020_2013-12-09T02-03-41.dat]
2015-05-04 16:08:32,526 INFO Stacking [UNMIXING_ERROR] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_FC_120_-020_2013-12-18T01-56-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/120_-020/2013/mosaic_cache/LS8_OLI_TIRS_PQA_120_-020_2013-12-18T01-56-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/tmp/LS8_OLI_TIRS_FC_WITH_PQA_STACK_UNMIXING_ERROR_120_-020_2013-12-18T01-56-59.dat]
</pre></div>
</div>
<div class="literal-block-wrapper container" id="envi-fc-stack-outputs">
<div class="code-block-caption"><span class="caption-text">ENVI FC stack outputs</span><a class="headerlink" href="#envi-fc-stack-outputs" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ ls -lh

-rw-r----- 1 sjo547 u46 92M May  4 16:08 LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-02T01-57-07.dat
-rw-r----- 1 sjo547 u46 669 May  4 16:08 LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-02T01-57-07.hdr

-rw-r----- 1 sjo547 u46 92M May  4 16:08 LS8_OLI_TIRS_FC_WITH_PQA_STACK_NON_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-02T01-57-07.dat
-rw-r----- 1 sjo547 u46 689 May  4 16:08 LS8_OLI_TIRS_FC_WITH_PQA_STACK_NON_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-02T01-57-07.hdr

-rw-r----- 1 sjo547 u46 92M May  4 16:07 LS8_OLI_TIRS_FC_WITH_PQA_STACK_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-02T01-57-07.dat
-rw-r----- 1 sjo547 u46 685 May  4 16:07 LS8_OLI_TIRS_FC_WITH_PQA_STACK_PHOTOSYNTHETIC_VEGETATION_120_-020_2013-12-02T01-57-07.hdr

-rw-r----- 1 sjo547 u46 92M May  4 16:08 LS8_OLI_TIRS_FC_WITH_PQA_STACK_UNMIXING_ERROR_120_-020_2013-12-02T01-57-07.dat
-rw-r----- 1 sjo547 u46 674 May  4 16:08 LS8_OLI_TIRS_FC_WITH_PQA_STACK_UNMIXING_ERROR_120_-020_2013-12-02T01-57-07.hdr
</pre></div>
</div>
</div>
<div class="literal-block-wrapper container" id="ls8-oli-tirs-fc-with-pqa-stack-bare-soil-120-020-2013-12-02t01-57-07-dat">
<div class="code-block-caption"><span class="caption-text"><cite>LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-02T01-57-07.dat</cite>...</span><a class="headerlink" href="#ls8-oli-tirs-fc-with-pqa-stack-bare-soil-120-020-2013-12-02t01-57-07-dat" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ gdalinfo LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-02T01-57-07.dat

Driver: ENVI/ENVI .hdr Labelled
Files: LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-02T01-57-07.dat
       LS8_OLI_TIRS_FC_WITH_PQA_STACK_BARE_SOIL_120_-020_2013-12-02T01-57-07.hdr
Size is 4000, 4000
...
Origin = (120.000000000000000,-19.000000000000000)
Pixel Size = (0.000250000000000,-0.000250000000000)
...
Metadata:
  ACQUISITION_DATE=2013_12_01 to 2013_12_31
  DATASET_TYPE=FC25
  PIXEL_QUALITY_FILTER=PQ_MASK_CLEAR
  SATELLITES=LS8
  X_INDEX=120
  Y_INDEX=-020
  Band_1=LS8_OLI_TIRS_FC_120_-020_2013-12-02T01-57-07.vrt
  Band_2=LS8_OLI_TIRS_FC_120_-020_2013-12-09T02-03-41.tif
  Band_3=LS8_OLI_TIRS_FC_120_-020_2013-12-18T01-56-59.vrt
...
Band 1 Block=4000x1 Type=Int16, ColorInterp=Gray
  Description = LS8_OLI_TIRS_FC_120_-020_2013-12-02T01-57-07.vrt
  NoData Value=-999
  Metadata:
    ACQ_DATE=2013_12_02
    SATELLITE=LS8
...
Band 2 Block=4000x1 Type=Int16, ColorInterp=Undefined
  Description = LS8_OLI_TIRS_FC_120_-020_2013-12-09T02-03-41.tif
  NoData Value=-999
  Metadata:
    ACQ_DATE=2013_12_09
    SATELLITE=LS8
...
Band 3 Block=4000x1 Type=Int16, ColorInterp=Undefined
  Description = LS8_OLI_TIRS_FC_120_-020_2013-12-18T01-56-59.vrt
  NoData Value=-999
  Metadata:
    ACQ_DATE=2013_12_18
    SATELLITE=LS8
</pre></div>
</div>
</div>
<p>To stack the <strong>COMMON</strong> ARG25 bands across Landsat 5, 7, and 8:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset_stack.py --x 120 --y -20 --satellite LS5 LS7 LS8 --acq-min 2013-12 --acq-max 2013-12 --dataset-type ARG25 --mask-pqa-apply --output-directory /tmp --bands-common

2015-05-04 14:07:06,396 INFO
        acq = 2013-12-01 to 2013-12-31
        satellites = LS5 LS7 LS8
        PQA mask = PQ_MASK_CLEAR
        WOFS mask =

2015-05-04 14:07:06,396 INFO
        x = 120
        y = -020

2015-05-04 14:07:06,396 INFO
        datasets to retrieve = ARG25
        bands to retrieve = [&#39;BLUE&#39;, &#39;GREEN&#39;, &#39;RED&#39;, &#39;NEAR_INFRARED&#39;, &#39;SHORT_WAVE_INFRARED_1&#39;, &#39;SHORT_WAVE_INFRARED_2&#39;]
        output directory = /tmp
        over write existing = False
        list only = False
</pre></div>
</div>
<div class="literal-block-wrapper container" id="nbar-stack-outputs-common">
<div class="code-block-caption"><span class="caption-text">NBAR stack outputs - <strong>COMMON</strong></span><a class="headerlink" href="#nbar-stack-outputs-common" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ ls -lh

-rw-r----- 1 sjo547 u46 154M May  4 14:07 LS7_ETM_NBAR_WITH_PQA_STACK_BLUE_120_-020_2013-12-01T01-58-23.045319.tif
-rw-r----- 1 sjo547 u46 154M May  4 14:08 LS7_ETM_NBAR_WITH_PQA_STACK_GREEN_120_-020_2013-12-01T01-58-23.045319.tif
-rw-r----- 1 sjo547 u46 154M May  4 14:10 LS7_ETM_NBAR_WITH_PQA_STACK_NEAR_INFRARED_120_-020_2013-12-01T01-58-23.045319.tif
-rw-r----- 1 sjo547 u46 154M May  4 14:09 LS7_ETM_NBAR_WITH_PQA_STACK_RED_120_-020_2013-12-01T01-58-23.045319.tif
-rw-r----- 1 sjo547 u46 154M May  4 14:11 LS7_ETM_NBAR_WITH_PQA_STACK_SHORT_WAVE_INFRARED_1_120_-020_2013-12-01T01-58-23.045319.tif
-rw-r----- 1 sjo547 u46 154M May  4 14:12 LS7_ETM_NBAR_WITH_PQA_STACK_SHORT_WAVE_INFRARED_2_120_-020_2013-12-01T01-58-23.045319.tif
</pre></div>
</div>
</div>
<p>To stack <strong>ALL</strong> ARG25 bands across Landsat 5, 7, and 8:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset_stack.py --x 120 --y -20 --satellite LS5 LS7 LS8 --acq-min 2013-12 --acq-max 2013-12 --dataset-type ARG25 --mask-pqa-apply --output-directory /tmp --bands-all

2015-05-04 14:15:29,724 INFO
        acq = 2013-12-01 to 2013-12-31
        satellites = LS5 LS7 LS8
        PQA mask = PQ_MASK_CLEAR
        WOFS mask =

2015-05-04 14:15:29,725 INFO
        x = 120
        y = -020

2015-05-04 14:15:29,725 INFO
        datasets to retrieve = ARG25
        bands to retrieve = [&#39;BLUE&#39;, &#39;GREEN&#39;, &#39;RED&#39;, &#39;NEAR_INFRARED&#39;, &#39;SHORT_WAVE_INFRARED_1&#39;, &#39;SHORT_WAVE_INFRARED_2&#39;, &#39;COASTAL_AEROSOL&#39;]
        output directory = /g/data/u46/sjo/testing/0.1.0
        over write existing = False
        list only = False
</pre></div>
</div>
<div class="literal-block-wrapper container" id="nbar-stack-outputs-all">
<div class="code-block-caption"><span class="caption-text">NBAR stack outputs - <strong>ALL</strong></span><a class="headerlink" href="#nbar-stack-outputs-all" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ ls -lh

-rw-r----- 1 sjo547 u46 154M May  4 14:16 LS7_ETM_NBAR_WITH_PQA_STACK_BLUE_120_-020_2013-12-01T01-58-23.045319.tif
-rw-r----- 1 sjo547 u46 154M May  4 14:17 LS7_ETM_NBAR_WITH_PQA_STACK_GREEN_120_-020_2013-12-01T01-58-23.045319.tif
-rw-r----- 1 sjo547 u46 154M May  4 14:18 LS7_ETM_NBAR_WITH_PQA_STACK_NEAR_INFRARED_120_-020_2013-12-01T01-58-23.045319.tif
-rw-r----- 1 sjo547 u46 154M May  4 14:18 LS7_ETM_NBAR_WITH_PQA_STACK_RED_120_-020_2013-12-01T01-58-23.045319.tif
-rw-r----- 1 sjo547 u46 154M May  4 14:19 LS7_ETM_NBAR_WITH_PQA_STACK_SHORT_WAVE_INFRARED_1_120_-020_2013-12-01T01-58-23.045319.tif
-rw-r----- 1 sjo547 u46 154M May  4 14:20 LS7_ETM_NBAR_WITH_PQA_STACK_SHORT_WAVE_INFRARED_2_120_-020_2013-12-01T01-58-23.045319.tif

-rw-r----- 1 sjo547 u46 154M May  4 14:21 LS8_OLI_TIRS_NBAR_WITH_PQA_STACK_COASTAL_AEROSOL_120_-020_2013-12-02T01-57-07.tif
</pre></div>
</div>
</div>
<p>Creating a stack applying a mask from a vector file:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_dataset_stack.py --acq-min 2013-10-11 --acq-max 2013-10-11 --satellite LS8 --x 148 --y -36 --dataset-type ARG25 --output-directory $PWD --mask-pqa-apply --mask-vector-apply --mask-vector-file australian_shapes.shp --mask-vector-layer 0 --mask-vector-feature 4

2015-05-07 10:42:18,414 INFO
        acq = 2013-10-11 to 2013-10-11
        satellites = LS8
        PQA mask = PQ_MASK_CLEAR
        WOFS mask =

2015-05-07 10:42:18,414 INFO
        x = 148
        y = -036
        VECTOR mask = file=australian_states.shp layer=0 feature=4

2015-05-07 10:42:18,414 INFO
        datasets to retrieve = ARG25
        bands to retrieve = [&#39;COASTAL_AEROSOL&#39;, &#39;BLUE&#39;, &#39;GREEN&#39;, &#39;RED&#39;, &#39;NEAR_INFRARED&#39;, &#39;SHORT_WAVE_INFRARED_1&#39;, &#39;SHORT_WAVE_INFRARED_2&#39;]
        output directory = /tmp
        over write existing = False
        list only = False
        output format = GEOTIFF

2015-05-07 10:42:19,743 INFO Total tiles found [1]

2015-05-07 10:42:19,743 INFO Creating stack for band [COASTAL_AEROSOL]
2015-05-07 10:42:19,743 INFO Total tiles for band [COASTAL_AEROSOL] is [1]
2015-05-07 10:42:20,045 INFO Stacking [COASTAL_AEROSOL] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_PQA_148_-036_2013-10-11T23-51-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/g/data/u46/sjo/testing/0.1.0/LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_COASTAL_AEROSOL_148_-036_2013-10-11T23-51-59.tif]

2015-05-07 10:42:37,146 INFO Creating stack for band [BLUE]
2015-05-07 10:42:37,147 INFO Total tiles for band [BLUE] is [1]
2015-05-07 10:42:37,296 INFO Stacking [BLUE] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_PQA_148_-036_2013-10-11T23-51-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/g/data/u46/sjo/testing/0.1.0/LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_BLUE_148_-036_2013-10-11T23-51-59.tif]

2015-05-07 10:42:53,655 INFO Creating stack for band [GREEN]
2015-05-07 10:42:53,656 INFO Total tiles for band [GREEN] is [1]
2015-05-07 10:42:53,787 INFO Stacking [GREEN] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_PQA_148_-036_2013-10-11T23-51-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/g/data/u46/sjo/testing/0.1.0/LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_GREEN_148_-036_2013-10-11T23-51-59.tif]

2015-05-07 10:43:09,909 INFO Creating stack for band [RED]
2015-05-07 10:43:09,910 INFO Total tiles for band [RED] is [1]
2015-05-07 10:43:10,048 INFO Stacking [RED] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_PQA_148_-036_2013-10-11T23-51-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/g/data/u46/sjo/testing/0.1.0/LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_RED_148_-036_2013-10-11T23-51-59.tif]

2015-05-07 10:43:26,618 INFO Creating stack for band [NEAR_INFRARED]
2015-05-07 10:43:26,619 INFO Total tiles for band [NEAR_INFRARED] is [1]
2015-05-07 10:43:26,750 INFO Stacking [NEAR_INFRARED] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_PQA_148_-036_2013-10-11T23-51-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/g/data/u46/sjo/testing/0.1.0/LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_NEAR_INFRARED_148_-036_2013-10-11T23-51-59.tif]

2015-05-07 10:43:42,793 INFO Creating stack for band [SHORT_WAVE_INFRARED_1]
2015-05-07 10:43:42,794 INFO Total tiles for band [SHORT_WAVE_INFRARED_1] is [1]
2015-05-07 10:43:42,933 INFO Stacking [SHORT_WAVE_INFRARED_1] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_PQA_148_-036_2013-10-11T23-51-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/g/data/u46/sjo/testing/0.1.0/LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_SHORT_WAVE_INFRARED_1_148_-036_2013-10-11T23-51-59.tif]

2015-05-07 10:43:58,455 INFO Creating stack for band [SHORT_WAVE_INFRARED_2]
2015-05-07 10:43:58,456 INFO Total tiles for band [SHORT_WAVE_INFRARED_2] is [1]
2015-05-07 10:43:58,585 INFO Stacking [SHORT_WAVE_INFRARED_2] band data from [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_NBAR_148_-036_2013-10-11T23-51-59.vrt] with PQA [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS8_OLI_TIRS/148_-036/2013/mosaic_cache/LS8_OLI_TIRS_PQA_148_-036_2013-10-11T23-51-59.tif] and PQA mask [[&lt;PqaMask.PQ_MASK_CLEAR: 16383&gt;]] and WOFS [] and WOFS mask [] to [/g/data/u46/sjo/testing/0.1.0/LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_SHORT_WAVE_INFRARED_2_148_-036_2013-10-11T23-51-59.tif]
</pre></div>
</div>
<div class="literal-block-wrapper container" id="arg25-stack-with-vector-mask-outputs">
<div class="code-block-caption"><span class="caption-text">ARG25 stack with vector mask outputs</span><a class="headerlink" href="#arg25-stack-with-vector-mask-outputs" title="Permalink to this code">¶</a></div>
<div class="highlight-text"><div class="highlight"><pre>$ ls -lh

-rw-r----- 1 sjo547 u46 31M May  7 10:42 LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_BLUE_148_-036_2013-10-11T23-51-59.tif
-rw-r----- 1 sjo547 u46 31M May  7 10:42 LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_COASTAL_AEROSOL_148_-036_2013-10-11T23-51-59.tif
-rw-r----- 1 sjo547 u46 31M May  7 10:43 LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_GREEN_148_-036_2013-10-11T23-51-59.tif
-rw-r----- 1 sjo547 u46 31M May  7 10:43 LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_NEAR_INFRARED_148_-036_2013-10-11T23-51-59.tif
-rw-r----- 1 sjo547 u46 31M May  7 10:43 LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_RED_148_-036_2013-10-11T23-51-59.tif
-rw-r----- 1 sjo547 u46 31M May  7 10:43 LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_SHORT_WAVE_INFRARED_1_148_-036_2013-10-11T23-51-59.tif
-rw-r----- 1 sjo547 u46 31M May  7 10:44 LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_SHORT_WAVE_INFRARED_2_148_-036_2013-10-11T23-51-59.tif
</pre></div>
</div>
</div>
<div class="figure" id="id8">
<img alt="_images/LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_COASTAL_AEROSOL_148_-036_2013-10-11T23-51-59.png" src="_images/LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_COASTAL_AEROSOL_148_-036_2013-10-11T23-51-59.png" />
<p class="caption"><span class="caption-text"><code class="docutils literal"><span class="pre">LS8_OLI_TIRS_NBAR_WITH_PQA_VECTOR_STACK_COASTAL_AEROSOL_148_-036_2013-10-11T23-51-59.tif</span></code></span></p>
</div>
</div>
</div>
<div class="section" id="retrieve-area-of-interest">
<h2>Retrieve Area of Interest<a class="headerlink" href="#retrieve-area-of-interest" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">TODO</p>
</div>
<p>The <em>Retrieve Area of Interest</em> tool ... .</p>
<p>It can retrieve both &#8220;physical&#8221; - NBAR, FC, PQA - and virtual/derived/calculated - NDVI, EVI, NBR, TCI - datasets:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_aoi.py -h

usage: retrieve_aoi_stack.py

       [-h]
       [--quiet | --verbose] [
       --acq-min ACQ_MIN] [--acq-max ACQ_MAX]
       [--satellite LS5 LS7 LS8 [LS5 LS7 LS8 ...]]
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The ACQ DATE parameters support dates being specified as <code class="docutils literal"><span class="pre">YYYY</span></code> or <code class="docutils literal"><span class="pre">YYYY-MM</span></code> or <code class="docutils literal"><span class="pre">YYYY-MM-DD</span></code>.</p>
<p>The MIN parameter maps the value down - i.e. <cite>2000</cite> -&gt; <cite>2000-01-01</cite> and <cite>2000-12</cite> -&gt; <cite>2012-12-01</cite></p>
<p class="last">The MAX parameter maps the value up - i.e. <cite>2000</cite> -&gt; <cite>2000-12-31</cite> and <cite>2000-01</cite> -&gt; <cite>2012-01-31</cite></p>
</div>
<div class="section" id="id3">
<h3>Example Uses<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">TODO</p>
</div>
</div>
</div>
<div class="section" id="retrieve-area-of-interest-time-series">
<h2>Retrieve Area of Interest Time Series<a class="headerlink" href="#retrieve-area-of-interest-time-series" title="Permalink to this headline">¶</a></h2>
<p>The <em>Retrieve Area of Interest Time Series</em> tool retrieves the given area of interest, summarises it to <em>a value</em> - for
example the minimum/maximum/mean of a variable - and presents the results as time-series of those values.</p>
<p>It can retrieve both &#8220;physical&#8221; - NBAR, FC, PQA - and virtual/derived/calculated - NDVI, EVI, NBR, TCI - datasets:</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_aoi_time_series.py -h

usage: retrieve_aoi_time_series.py

       [-h]
       [--quiet | --verbose]
       --acq-min ACQ_MIN] [--acq-max ACQ_MAX]
       [--satellite LS5 LS7 LS8 [LS5 LS7 LS8 ...]]
       [--mask-pqa-apply]
       [--mask-pqa-mask PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR [PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR ...]]
       [--mask-wofs-apply]
       [--mask-wofs-mask DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET [DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET ...]]
       --vector-file VECTOR_FILE
       [--vector-layer VECTOR_LAYER]
       [--vector-feature VECTOR_FEATURE]
       [--dataset-type ARG25 PQ25 FC25 WATER DSM DEM DEM_HYDROLOGICALLY_ENFORCED DEM_SMOOTHED NDVI EVI NBR TCI]
       [--band BANDS [BANDS ...]]
       [--output-directory OUTPUT_DIRECTORY]
       [--overwrite]
       [--list-only]
       [--hide-no-data]

Retrieve AOI Time Series

optional arguments:
  -h, --help            show this help message and exit
  --quiet               Less output
  --verbose             More output
  --acq-min ACQ_MIN     Acquisition Date
  --acq-max ACQ_MAX     Acquisition Date
  --satellite LS5 LS7 LS8 [LS5 LS7 LS8 ...]
                        The satellite(s) to include
  --mask-pqa-apply      Apply PQA mask
  --mask-pqa-mask PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR [PQ_MASK_SATURATION_THERMAL PQ_MASK_SATURATION_OPTICAL PQ_MASK_SATURATION PQ_MASK_CONTIGUITY PQ_MASK_LAND PQ_MASK_CLOUD_ACCA PQ_MASK_CLOUD_FMASK PQ_MASK_CLOUD_SHADOW_ACCA PQ_MASK_CLOUD_SHADOW_FMASK PQ_MASK_CLOUD PQ_MASK_CLEAR ...]
                        The PQA mask to apply
  --mask-wofs-apply     Apply WOFS mask
  --mask-wofs-mask DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET [DRY NO_DATA SATURATION_CONTIGUITY SEA_WATER TERRAIN_SHADOW HIGH_SLOPE CLOUD_SHADOW CLOUD WET ...]
                        The WOFS mask to apply
  --vector-file VECTOR_FILE
                        Vector file containing area of interest shape
  --vector-layer VECTOR_LAYER
                        Layer (0 based index) within vector file
  --vector-feature VECTOR_FEATURE
                        Feature (0 based index) within vector layer
  --dataset-type ARG25 PQ25 FC25 WATER DSM DEM DEM_HYDROLOGICALLY_ENFORCED DEM_SMOOTHED NDVI EVI NBR TCI
                        The types of dataset to retrieve
  --band BANDS [BANDS ...]
                        The band(s) to retrieve
  --output-directory OUTPUT_DIRECTORY
                        Output directory
  --overwrite           Over write existing output file
  --list-only           Just list datasets that would be processed
  --hide-no-data        Don&#39;t output records that are completely no data value(s)
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The ACQ DATE parameters support dates being specified as <code class="docutils literal"><span class="pre">YYYY</span></code> or <code class="docutils literal"><span class="pre">YYYY-MM</span></code> or <code class="docutils literal"><span class="pre">YYYY-MM-DD</span></code>.</p>
<p>The MIN parameter maps the value down - i.e. <cite>2000</cite> -&gt; <cite>2000-01-01</cite> and <cite>2000-12</cite> -&gt; <cite>2012-12-01</cite></p>
<p class="last">The MAX parameter maps the value up - i.e. <cite>2000</cite> -&gt; <cite>2000-12-31</cite> and <cite>2000-01</cite> -&gt; <cite>2012-01-31</cite></p>
</div>
<div class="section" id="id4">
<h3>Example Uses<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>To retrieve an <em>Area of Interest</em> time series of the <em>Fractional Cover</em> datasets from 2014 for the area specified in
the <code class="docutils literal"><span class="pre">adam.kml</span></code> vector file (layer 0, feature 0):</p>
<div class="highlight-python"><div class="highlight"><pre>$ retrieve_aoi_time_series.py --vector-file adam.kml --acq-min 2014 --acq-max 2014 --mask-pqa-apply --mask-wofs-apply --dataset-type FC25 --band 1 --output-directory /tmp

INFO:root:
        acq = 2014-01-01 to 2014-12-31
        satellites = LS5 LS7
        PQA mask = PQ_MASK_CLEAR
        WOFS mask = WET

INFO:root:
        vector file = adam.kml
        layer ID = 0
        feature = 0

INFO:root:
        dataset type = FC25
        bands = [1]
        output directory = /tmp
        over write existing = False
        list only = False
        output no data values = True

INFO:root:dataset bands [PHOTOSYNTHETIC_VEGETATION NON_PHOTOSYNTHETIC_VEGETATION BARE_SOIL UNMIXING_ERROR]

INFO:root:Using bands [PHOTOSYNTHETIC_VEGETATION]

INFO:root:Processing cell [145/ -20]

INFO:root:There are [33] tiles

INFO:root:Writing output to /tmp/output.csv

INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-01-02T00-19-14.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/LS7_ETM_FC_145_-020_2014-01-18T00-19-49.tif]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-02-12T00-13-26.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/LS7_ETM_FC_145_-020_2014-02-28T00-13-43.tif]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/LS7_ETM_FC_145_-020_2014-03-07T00-19-59.tif]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/LS7_ETM_FC_145_-020_2014-03-23T00-20-06.tif]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/LS7_ETM_FC_145_-020_2014-04-01T00-13-59.tif]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-04-08T00-19-46.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/LS7_ETM_FC_145_-020_2014-04-17T00-14-07.tif]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-05-03T00-13-50.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-05-19T00-13-57.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-05-26T00-20-09.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-06-04T00-14-01.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-06-20T00-14-01.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-06-27T00-20-16.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-07-06T00-14-08.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-07-13T00-20-19.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-07-22T00-14-11.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-07-29T00-20-25.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/LS7_ETM_FC_145_-020_2014-08-07T00-14-40.tif]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/LS7_ETM_FC_145_-020_2014-08-14T00-20-50.tif]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-08-23T00-14-14.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-08-30T00-20-25.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-09-08T00-14-16.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-10-10T00-14-34.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-10-17T00-20-48.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-10-26T00-14-43.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-11-02T00-20-58.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-11-11T00-14-52.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-11-18T00-21-02.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-12-04T00-21-10.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-12-13T00-15-04.vrt]
INFO:root:Processing tile [/g/data/rs0/tiles/EPSG4326_1deg_0.00025pixel/LS7_ETM/145_-020/2014/mosaic_cache/LS7_ETM_FC_145_-020_2014-12-20T00-21-19.vrt]
</pre></div>
</div>
<p>Which gives <code class="docutils literal"><span class="pre">output.csv</span></code> containing:</p>
<div class="figure">
<img alt="_images/retrieve_aoi_time_series_csv.png" src="_images/retrieve_aoi_time_series_csv.png" />
</div>
<p>This could be graphed using the tool of your choice something like:</p>
<div class="figure">
<img alt="_images/retrieve_aoi_time_series_graph.png" src="_images/retrieve_aoi_time_series_graph.png" />
</div>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span>Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span>Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span>Search Page</span></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">agdc-api 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Geoscience Australia.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>